name: CI
on: push
jobs:
  build:
    strategy:
      matrix:
        platform: [Win32, x64]
        configuration: [Debug, Release]
    runs-on: windows-latest
    steps:
    - id: cache
      run: echo "::set-output name=dir::$env:VCPKG_INSTALLATION_ROOT"
    - uses: actions/cache@v1
      with:
        key: vcpkg-${{matrix.platform}}
        path: ${{steps.cache.outputs.dir}}/installed
    - uses: actions/checkout@v1
    - run: |
        $env:Path += ";C:\Program Files (x86)\Microsoft Visual Studio\2019\Enterprise\MSBuild\Current\Bin"
        vcpkg integrate install
        vcpkg install boost-regex:$("${{matrix.platform}}" -replace "Win32", "x86")-windows-static
        MSBuild ffftp.sln "/p:Platform=${{matrix.platform}};Configuration=${{matrix.configuration}}"
